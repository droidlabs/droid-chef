# encoding: utf-8

##
# Backup v4.x Configuration
#
# Documentation: http://meskyanichi.github.io/backup
# Issue Tracker: https://github.com/meskyanichi/backup/issues


##
# Config Options
#
# The options here may be overridden on the command line, but the result
# will depend on the use of --root-path on the command line.
#
# If --root-path is used on the command line, then all paths set here
# will be overridden. If a path (like --tmp-path) is not given along with
# --root-path, that path will use it's default location _relative to --root-path_.
#
# If --root-path is not used on the command line, a path option (like --tmp-path)
# given on the command line will override the tmp_path set here, but all other
# paths set here will be used.
#
# Note that relative paths given on the command line without --root-path
# are relative to the current directory. The root_path set here only applies
# to relative paths set here.
#
# ---
#
# Sets the root path for all relative paths, including default paths.
# May be an absolute path, or relative to the current working directory.
#

root_path '<%= @root_path %>'

#
# Sets the path where backups are processed until they're stored.
# This must have enough free space to hold apx. 2 backups.
# May be an absolute path, or relative to the current directory or +root_path+.
#
tmp_path  '<%= @tmp_path %>'
#
# Sets the path where backup stores persistent information.
# When Backup's Cycler is used, small YAML files are stored here.
# May be an absolute path, or relative to the current directory or +root_path+.
#
data_path '<%= @data_path %>'


#
# Utilities
#
# If you need to use a utility other than the one Backup detects,
# or a utility can not be found in your $PATH.
#
#   Utilities.configure do
#     tar       '/usr/bin/gnutar'
#     redis_cli '/opt/redis/redis-cli'
#   end

##
# Logging
#
# Logging options may be set on the command line, but certain settings
# may only be configured here.
#
#   Logger.configure do
#     console.quiet     = true            # Same as command line: --quiet
#     logfile.max_bytes = 2_000_000       # Default: 500_000
#     syslog.enabled    = true            # Same as command line: --syslog
#     syslog.ident      = 'my_app_backup' # Default: 'backup'
#   end
#
# Command line options will override those set here.
# For example, the following would override the example settings above
# to disable syslog and enable console output.
#   backup perform --trigger my_backup --no-syslog --no-quiet

##
# Component Defaults
#
# Set default options to be applied to components in all models.
# Options set within a model will override those set here.
#
#   Storage::S3.defaults do |s3|
#     s3.access_key_id     = "my_access_key_id"
#     s3.secret_access_key = "my_secret_access_key"
#   end
#
<%- if node.backup.notifiers.has_key?('mail') %>

Notifier::Mail.defaults do |mail|

  mail.on_success           = '<%= "#{node['backup']['notifiers']['mail']['on_success']}" %>'
  mail.on_warning           = '<%= "#{node['backup']['notifiers']['mail']['on_warning']}" %>'
  mail.on_failure           = '<%= "#{node['backup']['notifiers']['mail']['on_failure']}" %>'

  mail.from                 = '<%= "#{node['backup']['notifiers']['mail']['from']}" %>'
  mail.to                   = '<%= "#{node['backup']['notifiers']['mail']['to']}" %>'
  mail.address              = '<%= "#{node['backup']['notifiers']['mail']['address']}" %>'
  mail.port                 = <%= "#{node['backup']['notifiers']['mail']['port']}" %>
  mail.domain               = '<%= "#{node['backup']['notifiers']['mail']['domain']}" %>'
  mail.user_name            = '<%= "#{node['backup']['notifiers']['mail']['user_name']}" %>'
  mail.password             = '<%= "#{node['backup']['notifiers']['mail']['password']}" %>'
  mail.authentication       = '<%= "#{node['backup']['notifiers']['mail']['authentication']}" %>'
  mail.encryption           = <%= "#{node['backup']['notifiers']['mail']['encryption']}" %>
end

<%- end %>
